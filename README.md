# Churn Prediction 
  
Проект, демонстрирующий полный цикл работы с моделью машинного обучения: от обучения на датасете до предоставления предсказаний через веб-сервис.

**Задача проекта**: построить модель предсказания оттока клиентов телеком-компании и обернуть её в REST API с помощью FastAPI.


---  


## Что реализовано

**Обучение модели (`train.py`)**  
  - Загружаются сырые данные `telco_churn.csv`.  
  - Делается базовая предобработка: удаление ненужных столбцов, приведение типов, кодирование категориальных признаков.  
  - Собирается простой пайплайн с `RandomForestClassifier`.  
  - Считаются метрики качества: ROC-AUC, Accuracy.  
  - Обученная модель сохраняется в `artifacts/model.pkl`.  

**Предсказания (`inference.py`)**  
  - Загружается сохранённая модель.  
  - На вход подаётся словарь с признаками одного клиента.  
  - Функция возвращает вероятность оттока и итоговую метку (`will_churn` или `stay`).  

 **API (`api.py`)**  
  - `GET /health` для проверки, что сервис работает.  
  - `POST /predict` принимает JSON с данными клиента и отдаёт прогноз.  

 **Тесты**   
  - В папке `tests/` — простой тест для проверки API. 


---


***Данные и модель не хранятся в репозитории — их нужно скачивать/обучать отдельно.***


## Как пользоваться

1.  **Скачать данные**

    [Telco Customer Churn (Kaggle)](https://www.kaggle.com/blastchar/telco-customer-churn)  

    Сохранить файл как:  
    ```
    data/telco_churn.csv
    ```

3. **Установить зависимости**
   ```
   python -m venv .venv
   ```
   Windows:
   ```
   .\.venv\Scripts\Activate.ps1
   ```
   Linux / macOS:
   ```
   source .venv/bin/activate
   ```
   
   ```
   pip install -r requirements.txt
   ```
4. **Обучить модель**
   ```
   python src/train.py
   ```
  
   В консоль выведутся метрики, а модель сохранится в:
   ```
   artifacts/model.pkl
   ```

5. **Запустить API**
    ```
    uvicorn src.api:app --reload
    ```
    
    Проверить работу:
    ```
    #Проверка
    curl http://127.0.0.1:8000/health
    
    #Пример предсказания:
    curl -X POST "http://127.0.0.1:8000/predict" `
      -H "Content-Type: application/json" `
      -d (Get-Content -Raw .\examples\request.json)
    ```
    
    После запроса сервер вернёт что-то вроде:
    ```
    {
      "churn_probability": 0.82,
      "prediction": "will_churn",
      "threshold": 0.5
    }
    ```

6. **Запустить тесты**
  ```
  pytest -q
  ```

## Что можно добавить
- Добавить больше метрик.

- Реализовать поддержку батч-предсказания в API.

- Настроить CI через GitHub Actions.

## Примечание
Цель проекта — практика и демонстрация базового MLOps-пайплайна, а не идеальное качество модели.
